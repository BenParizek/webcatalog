<% include ../partials/header %>

<section class="section app">
  <div class="container">
    <nav class="level">
      <div class="level-left">
        <div class="level-item">
          <h1 class="title ">
            <a href="/apps">WebCatalog Store</a>
            <% if (app.category) { %>
            <span> > </span>
            <a class="category" href="/apps/category/<%= app.category %>"><%= app.category.replace('+', ' & ') %></a>
            <% } %>
          </h1>
        </div>
      </div>
      <div class="level-right">
        <div class="level-item">
          <form class="field is-pulled-right" action="/apps/search">
            <p class="control">
              <input class="input" type="text" placeholder="Search..." name="query">
            </p>
          </form>
        </div>
      </div>
    </nav>
    <hr>
    <div class="columns">
      <div class="column is-4">
        <div class="content">
          <div class="has-text-centered">
            <a href="/s3/<%= app.id %>.png">
              <figure class="image is-128x128 app-icon">
                <picture>
                  <source srcset="/s3/<%= app.id %>.webp" type="image/webp">
                  <source srcset="/s3/<%= app.id %>.png" type="image/jpeg">
                  <img src="/s3/<%= app.id %>.png" alt="<%= app.name %> on the WebCatalog Store">
                </picture>
              </figure>
            </a>
            <h1 class="title"><%= app.name %></h1>
            <h2 class="subtitle is-6"><a href="<%= app.url %>" target="_blank" rel="noopener noreferrer"><%= extractDomain(app.url) %></a></h2>
            <a class="button is-info open" href="webcatalog://apps/<%= app.id %>">Install with WebCatalog</a>
            <p>Don't have WebCatalog? <a href="/downloads">Download for free.</a></p>

            <div id="fb-root"></div>
            <script>(function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0];
              if (d.getElementById(id)) return;
              js = d.createElement(s); js.id = id;
              js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9&appId=421147911601047";
              fjs.parentNode.insertBefore(js, fjs);
            }(document, 'script', 'facebook-jssdk'));</script>
            <div class="fb-share-button" data-href="https://getwebcatalog.com/apps/details/<%= app.slug %>/<%= app.id %>" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=<%= encodeURIComponent("https://getwebcatalog.com/apps/details/" + app.slug + "/" + app.id) %>&amp;src=sdkpreparse">Share</a></div>

            <script>window.twttr = (function(d, s, id) {
              var js, fjs = d.getElementsByTagName(s)[0],
                t = window.twttr || {};
              if (d.getElementById(id)) return t;
              js = d.createElement(s);
              js.id = id;
              js.src = "https://platform.twitter.com/widgets.js";
              fjs.parentNode.insertBefore(js, fjs);

              t._e = [];
              t.ready = function(f) {
                t._e.push(f);
              };

              return t;
            }(document, "script", "twitter-wjs"));</script>
            <div class="twitter-share-button-container"><a class="twitter-share-button" href="https://twitter.com/intent/tweet">Tweet</a></div>

            <% if (user && user.isAdmin) { %>
            <a class="button" href="/admin/edit/id<%= app.id %>">
              <span class="icon">
                <i class="fa fa-pencil"></i>
              </span>
            </a>
            <% } %>
          </div>
        </div>
      </div>
      <div class="column">
        <div class="content">
          <% if (app.description) { %>
          <p><%= app.description %> <a href="https://en.wikipedia.org/wiki/<%= encodeURIComponent(app.wikipediaTitle || app.name) %>" target="_blank" rel="noopener noreferrer">Wikipedia</a></p>
          <% } %>

          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- Single -->
          <ins class="adsbygoogle"
               style="display:block"
               data-ad-client="ca-pub-3770617531645838"
               data-ad-slot="9512124102"
               data-ad-format="auto"></ins>
          <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
      </div>
    </div>
  </div>
</section>

<% include ../partials/footer %>
